<html>

<head>
<style>
#canvas{
background: pink;
width: 500px;
height: 500px;
}
</style>
</head>

<body id="bdy">
</body>
<script>

// return [CanvasNode, SelectNode, AddClassNode, AddLineNode]
function NewUMLEditor()
{
    var ClassModel = function()
    {
    };
    var UMLEditorModel = function(
        OnNewClass
    )
    {
        var that = this;
        var do_nothing = function(){};
        // Model call these to do changes in UI
        this.UIReflectors = {
            ChangeButtonState: {
                ChangeSelectButton: do_nothing,
                ChangeAddClassButton: do_nothing,
                ChangeAddLineButton: do_nothing
            }
        };
        function ClickButton(id)
        {
            for(var key in Button)
                if(key != id)
                    this.ButtonUpdaters[key](false);
            this.ButtonUpdaters[id](true);
        };
        // @param   which ClassModel is clicked
        this.MouseDownClass = function(_class)
        {
        };
        this.MouseUpClass = function()
        {
        };
        this.MouseMove = function()
        {
        };
        this.MouseLeave = function()
        {
        };
        var ClickButton = function(rname)
        {
            var cbs = this.UIReflectors.ChangeButtonState;
            for(var attr_name in cbs)
                if(attr_name != rname)
                    cbs[attr_name](false);
            cbs[rname](true);
        }
        this.ClickSelectButton = function()
        {
            ClickButton.call(this, "ChangeSelectButton");
        };
        this.ClickAddClassButton = function()
        {
            ClickButton.call(this, "ChangeAddClassButton");
        };
        this.ClickAddLineButton = function()
        {
            ClickButton.call(this, "ChangeAddLineButton");
        };
    };
    // @param model UMLEditorModel
    function NewSelectNode(model)
    {
        var np = document.createElement('input');
        np.type = 'button';
        np.value = 'Select';
        np.onclick = function()
        {
            model.ClickSelectButton();
        };
        model.UIReflectors.ChangeButtonState
            .ChangeSelectButton = function(active)
        {
            np.style.color = active?'black':'gray';
            np.style.fontWeight = active?'bold':'normal';
        };
        return np;
    }
    // @param model UMLEditorModel
    function NewAddClassNode(model)
    {
        var np = document.createElement('input');
        np.type = 'button';
        np.value = 'Add Class';
        np.onclick = function()
        {
            model.ClickAddClassButton();
        };
        model.UIReflectors.ChangeButtonState
            .ChangeAddClassButton = function(active)
        {
            np.style.color = active?'black':'gray';
            np.style.fontWeight = active?'bold':'normal';
        };
        return np;
    }
    // @param model UMLEditorModel
    function NewAddLineNode(model)
    {
        var np = document.createElement('input');
        np.type = 'button';
        np.value = 'Add Line';
        np.onclick = function()
        {
            model.ClickAddLineButton();
        };
        model.UIReflectors.ChangeButtonState
            .ChangeAddLineButton = function(active)
        {
            np.style.color = active?'black':'gray';
            np.style.fontWeight = active?'bold':'normal';
        };
        return np;
    }
    // @param model UMLEditorModel
    function NewCanvasNode(model)
    {
        var div = document.createElement('div');
        div.style.background = 'pink';
        div.style.width  = 500;
        div.style.height = 500;
        return div;
    }
    var uml_editor_model = new UMLEditorModel();
    return [
        NewCanvasNode(uml_editor_model),
        NewSelectNode(uml_editor_model),
        NewAddClassNode(uml_editor_model),
        NewAddLineNode(uml_editor_model)
    ];
}

bdy.onload = function()
{
    var Nodes = NewUMLEditor();
    console.log(Nodes);
    bdy.appendChild(Nodes[1]);
    bdy.appendChild(Nodes[2]);
    bdy.appendChild(Nodes[3]);
    bdy.appendChild(Nodes[0]);
};
</script>
</html>
